#!/usr/bin/env ruby
# 
# Creates ctags index for Ruby project including bundled gems
#
# This script generates a tags file that enables code navigation in editors
# like Vim. It automatically includes:
# - Current directory (.) 
# - All gem paths from bundle list
# - Excludes pkg directory to avoid vendor code
#
# Usage: Run directly from project root

require 'infobar'

paths = %w[ . ] + `bundle list --paths`.lines.map(&:chomp)
cmd = %w[ ctags --recurse=yes --exclude=pkg --languages=Ruby,C ] + paths
Infobar.busy(label: 'Creating tags', frames: :braille7) { system(*cmd) }
if megabytes = File.size('tags').to_f / 1024 ** 2 rescue nil
  infobar.puts 'Created %.3fM of tags.' % megabytes
end
