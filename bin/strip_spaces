#!/usr/bin/env ruby

require 'spruz/secure_write'
include Spruz::SecureWrite

for file in ARGV
  secure_write(file) do |output|
    File.open(file) do |file|
      old_mode = file.stat.mode
      file.each do |line|
        line.gsub!(/[ \t\v]+$/, '')
        output.write line
      end
      File.chmod old_mode, output.path
    end
  end
end
