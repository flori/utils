#!/usr/bin/env ruby

require 'fileutils'
include FileUtils

case `uname -s`.chomp
when 'Darwin'
  profiles="#{ENV['HOME']}/Library/Application Support/Firefox/Profiles"
else
  profiles="#{ENV['HOME']}/.mozilla/firefox"
end

cd profiles do
  for p in Dir['*.default']
    cd p do
      for db in Dir['*.sqlite']
        print "Vacuuming #{db}..."
        system "sqlite3 #{db} VACUUM"
        puts "done."
      end
    end
  end
end
